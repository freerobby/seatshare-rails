<% if @group.is_admin(current_user) %>

<%= form_for :group, html: {class: "form-horizontal", role: "form"} do |f| %>

<fieldset>
  <legend>Group details</legend>

  <div class="form-group">
    <%= f.label :group_name, :class => 'col-md-3 control-label' %>
    <div class="col-md-9">
      <%= f.text_field :group_name, :class => 'form-control', :placeholder => 'Cellblock 303', :value => @group.group_name %>
    </div>
  </div>

  <div class="form-group">
    <%= f.label :invitation_code, :class => 'col-md-3 control-label' %>
    <div class="col-md-9">
      <%= f.text_field :group_name, :class => 'form-control', :disabled => true, :value => @group.invitation_code %>
    </div>
  </div>

</fieldset>

<div class="row">
  <div class="text-right col-md-12">
    <%= f.hidden_field :form_type, :value => 'group' %>
    <%= f.submit 'Update Group', :class => 'btn btn-primary' %>
  </div>
</div>

<% end %>

<% else %>

<fieldset>
  <legend>Group details</legend>

  <p class="lead">You are a member of <strong><%= @group.group_name %></strong>, a <strong><%= @group.entity.entity_name %></strong> group. You can choose to receive reminders when there is an upcoming event for this group.</p>

</fieldset>

<div class="row">
  <div class="text-right col-md-12">
    <%= link_to raw('<span class="glyphicon glyphicon-remove"></span> Leave Group'), { :action => 'leave', :id => @group.id }, :class => 'btn btn-large btn-danger' %> 
  </div>

</div>

<% end %>

<fieldset>
  <legend>Group members</legend>
  <table class="table table-striped table-bordered">
    <thead>
      <tr>
        <th class="action"></th>
        <th>Name</th>
        <th>Email</th>
      </tr>
    </thead>
    <tbody>
      <% for member in @group.members %>
      <tr>
        <td><%= image_tag member.gravatar %></td>
        <td><%= link_to member.full_name, {:controller => 'profiles', :action => 'show', :id => member.id } %></td>
        <td><%= mail_to member.email %></td>
      </tr>
      <% end %>
    </tbody>
  </table>

<div class="text-right">
  <%= link_to raw('<span class="glyphicon glyphicon-plus"></span> Invite Member'), { :controller => 'groups', :action => 'invite', :id => @group.id }, :class => 'btn btn-default btn-sm' %>
</div>


</fieldset>

<% content_for :sidebar do %>

<%= form_for :group_user, html: {class: "form-horizontal", role: "form"} do |f| %>

<fieldset>
  <legend>Reminder Settings</legend>

  <div class="form-group">
    <div class="col-md-12">
      <div class="checkbox">
        <label><%= f.check_box :daily_reminder %> Daily Schedule Reminder</label>
      </div>
      <div class="checkbox">
        <label><%= f.check_box :weekly_reminder%> Weekly Schedule Reminder</label>
      </div>
    </div>
  </div>

</fieldset>

<div class="row">
  <div class="text-right col-md-12">
    <%= f.hidden_field :form_type, :value => 'reminders' %>
    <%= f.submit 'Update Settings', :class => 'btn btn-secondary' %>
  </div>
</div>

<% end %>

<% end %>

<% content_for :page_footer do %>
<script>if (typeof mixpanel != 'undefined') { mixpanel.track("View edit group"); }</script>
<% end %>